{% extends "basic.html" %}

{% block content %}
<p> Type: <b>{{document.type}}</b> </p>
    {% for key, value in document.attributes.items() %}
<p> {{key}} : <b>{{value}}</b></p>
    {% endfor %}


    {% if user.type == "librarian" %}
        <h5> <a href=" {{url_for('edit_document', doc_id = document.id)}}">Edit</a></h5>
        <h5> <a href=" {{url_for('delete_document', doc_id = document.id)}}">Delete</a></h5>

    {% endif %}

    {% if document.type != "reference_book" %}
        <p> Available copies: {{available_copies}}</p>
        {% if available_copies > 0 and user.type == "librarian" %}
            <p><a href="{{url_for('delete_copy', origin_id=document.id)}}">Delete 1 copy</a></p>
            <p><a href="{{url_for('delete_copies', origin_id=document.id)}}">Delete all copies</a></p>
        {% endif %}
        {% if user.type == "librarian" %}
            <h5> Users</h5>
            {% for copy in held_copies %}
                <p> <a href="{{url_for('user', user_id=copy.attributes.user_id)}}"> {{names[loop.index0]}} {{copy.attributes.user_id}}</a>.
                deadline: {{copy.attributes.deadline}}
                overdue: {{overdue_days[loop.index0]}}
                <a href="{{url_for('return_document', copy_id = copy['id'])}}"> Return </a></p>
            {%endfor%}
        {% endif %}
        {% if user and user.type != "librarian"%}
            {% if checked %}
                {% if requested_to_return %}
                    You requested to return
                {% else %}
                    <h5> <a href="{{url_for('request_return', copy_id = copy_id)}}">Request to Return</a></h5>
                {% endif %}
            {% elif requested %}
                You requested to check out
            {% elif user.type != "unconfirmed" %}
                <h5> <a href="{{url_for('request_document', doc_id = document.id)}}">Request</a></h5>
            {% endif %}
        {%endif%}
    {% endif %}
{% endblock %}